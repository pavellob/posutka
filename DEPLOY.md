# Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Posutka GraphQL Federation Ğ½Ğ° Northflank

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
pnpm install

# Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
pnpm start:dev

# Ğ˜Ğ»Ğ¸ Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾:
pnpm start:subgraphs  # Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ğ¾Ğ´Ğ³Ñ€Ğ°Ñ„Ğ¾Ğ²
pnpm wait:subgraphs    # ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
pnpm mesh:compose      # Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° ÑÑƒĞ¿ĞµÑ€Ğ³Ñ€Ğ°Ñ„Ğ°
pnpm start:gateway     # Ğ—Ğ°Ğ¿ÑƒÑĞº gateway
```

### ĞŸÑ€Ğ¾Ğ´Ğ°ĞºÑˆĞ½ ÑĞ±Ğ¾Ñ€ĞºĞ°

```bash
# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¿Ñ€Ğ¾Ğ´Ğ°ĞºÑˆĞ½ Ğ²ĞµÑ€ÑĞ¸Ğ¸
pnpm build:prod

# Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°
pnpm build:docker

# Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Docker Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°
pnpm build:test
```

## ğŸ³ Docker

### Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°

```bash
docker build -t posutka-federation:latest .
```

### Ğ—Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°

```bash
docker run -d \
  --name posutka-federation \
  -p 4001:4001 \
  -p 4002:4002 \
  -p 4003:4003 \
  -p 4004:4004 \
  -p 4005:4005 \
  -p 4006:4006 \
  -p 4007:4007 \
  -p 4008:4008 \
  -p 4009:4009 \
  posutka-federation:latest
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

```bash
# Gateway (Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ endpoint)
curl http://localhost:4009/graphql

# ĞŸĞ¾Ğ´Ğ³Ñ€Ğ°Ñ„Ñ‹
curl http://localhost:4001/graphql  # Inventory
curl http://localhost:4002/graphql  # Bookings
# ... Ğ¸ Ñ‚.Ğ´.
```

## â˜ï¸ Northflank

### ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

Ğ¤Ğ°Ğ¹Ğ» `northflank.yml` ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ Ğ½Ğ° Northflank.

### ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ

Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ÑĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ² Northflank:

- `database-url` - URL Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº Ğ±Ğ°Ğ·Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹

1. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ Ğº Northflank
2. Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ ÑĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹
3. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹

### ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

- **Gateway**: `https://your-app.northflank.app/graphql`
- **ĞŸĞ¾Ğ´Ğ³Ñ€Ğ°Ñ„Ñ‹**: `https://your-app.northflank.app:4001-4008/graphql`

## ğŸ“Š ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Gateway (4009)                       â”‚
â”‚              GraphQL Federation Gateway                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
â”‚ 4001  â”‚ â”‚     4002      â”‚ â”‚ 4003  â”‚
â”‚Inventoryâ”‚ â”‚  Bookings    â”‚ â”‚  Ops  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
â”‚ 4004  â”‚ â”‚     4005      â”‚ â”‚ 4006  â”‚
â”‚Billing â”‚ â”‚  Identity     â”‚ â”‚Listingsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4007  â”‚ â”‚     4008      â”‚
â”‚ Legal â”‚ â”‚      AI       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ Troubleshooting

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ¼

1. **ĞŸĞ¾Ğ´Ğ³Ñ€Ğ°Ñ„Ñ‹ Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
2. **Gateway Ğ½Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚**: Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ Ğ²ÑĞµ Ğ¿Ğ¾Ğ´Ğ³Ñ€Ğ°Ñ„Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹
3. **ĞÑˆĞ¸Ğ±ĞºĞ¸ ÑĞ±Ğ¾Ñ€ĞºĞ¸**: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¸ Prisma ÑÑ…ĞµĞ¼Ñƒ

### Ğ›Ğ¾Ğ³Ğ¸

```bash
# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
docker logs posutka-federation

# Ğ¡Ğ»ĞµĞ´Ğ¸Ñ‚ÑŒ Ğ·Ğ° Ğ»Ğ¾Ğ³Ğ°Ğ¼Ğ¸ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
docker logs -f posutka-federation
```

### ĞÑ‡Ğ¸ÑÑ‚ĞºĞ°

```bash
# ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
docker stop posutka-federation
docker rm posutka-federation

# Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°
docker rmi posutka-federation:latest
```
