# üöÄ –î–µ–ø–ª–æ–π —Å pnpm —Å–∏–¥–∞–º–∏ –∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

## üìã –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å pnpm**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pnpm -C packages/datalayer-prisma prisma db push`
- Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã

### 2. **–ë–æ–≥–∞—Ç—ã–µ —Å–∏–¥—ã —Å pnpm**
- **TypeScript —Å–∏–¥—ã**: `pnpm -C packages/datalayer-prisma tsx prisma-seed.ts`
- **JavaScript —Å–∏–¥—ã**: `pnpm -C packages/datalayer-prisma seed`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Ç–∏–ø–∞ —Å–∏–¥–æ–≤

### 3. **–ë–æ–≥–∞—Ç—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ**
- **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è**: "Sunrise Stays B.V." —Å 2 —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
- **–°–≤–æ–π—Å—Ç–≤–∞**: "Canal View Apartments" –∏ "Harbor Loft Studios"
- **–ï–¥–∏–Ω–∏—Ü—ã**: 4 –µ–¥–∏–Ω–∏—Ü—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: Owner, Manager, Staff —Å —Ä–æ–ª—è–º–∏
- **–ì–æ—Å—Ç–∏**: Alice, Bob, Chen —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**: 3 –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ, –æ–∂–∏–¥–∞—é—â–µ–µ, –æ—Ç–º–µ–Ω–µ–Ω–Ω–æ–µ)
- **–ó–∞–¥–∞—á–∏**: –£–±–æ—Ä–∫–∞ –∏ —Ä–µ–º–æ–Ω—Ç —Å –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏ —É—Å–ª—É–≥
- **–°—á–µ—Ç–∞**: –ò–Ω–≤–æ–π—Å—ã —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏
- **–ü—Ä–∞–≤–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã**: –°–æ–≥–ª–∞—à–µ–Ω–∏—è –∏ GDPR

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞:
1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ë–î** ‚Üí `migrate-and-seed.sh`
   - –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
   - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ `prisma db push`
   - –ó–∞–ø—É—Å–∫ —Å–∏–¥–æ–≤ (TypeScript –∏–ª–∏ JavaScript)
2. **–ó–∞–ø—É—Å–∫ –ø–æ–¥–≥—Ä–∞—Ñ–æ–≤** ‚Üí `pnpm start:subgraphs`
3. **–û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏** ‚Üí `wait-for-subgraphs.sh`
4. **–°–±–æ—Ä–∫–∞ —Å—É–ø–µ—Ä–≥—Ä–∞—Ñ–∞** ‚Üí `pnpm mesh:compose`
5. **–ó–∞–ø—É—Å–∫ Gateway** ‚Üí `pnpm start:gateway`

### –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ —Å–∏–¥–æ–≤:
```bash
if [ -f "packages/datalayer-prisma/prisma-seed.ts" ]; then
  # TypeScript —Å–∏–¥—ã
  pnpm -C packages/datalayer-prisma tsx prisma-seed.ts
elif [ -f "packages/datalayer-prisma/prisma-seed.js" ]; then
  # JavaScript —Å–∏–¥—ã
  pnpm -C packages/datalayer-prisma seed
else
  # –°–∏–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
  echo "‚ÑπÔ∏è  –°–∏–¥—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
fi
```

## üöÄ –î–µ–ø–ª–æ–π

### 1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
# –ü–æ–ª—É—á–∏—Ç–µ DATABASE_URL
# –ü—Ä–∏–º–µ—Ä: postgresql://user:password@host:port/database
```

### 2. **–î–µ–ø–ª–æ–π –≤ Northflank**
```bash
# –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "Add pnpm-based migrations and rich seeds"
git push

# –í Northflank Dashboard:
# 1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç DATABASE_URL
# 2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
```

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Gateway
curl -X POST https://your-app.northflank.app/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"{ __schema { types { name } } }"}'

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–≥—Ä–∞—Ñ—ã
curl -X POST https://your-app.northflank.app:4001/graphql \
  -H "Content-Type: application/json" \
  -d '{"query":"{ __schema { types { name } } }"}'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- `üóÑÔ∏è –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π Prisma...`
- `‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...`
- `‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞!`
- `üå± –ó–∞–ø—É—Å–∫ —Å–∏–¥–æ–≤ —Å –ø–æ–º–æ—â—å—é pnpm...`
- `üì¶ –ù–∞–π–¥–µ–Ω—ã TypeScript —Å–∏–¥—ã, –∑–∞–ø—É—Å–∫–∞–µ–º...`
- `üéâ –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!`
- `üì¶ –ó–∞–ø—É—Å–∫ –ø–æ–¥–≥—Ä–∞—Ñ–æ–≤...`
- `‚úÖ –ü–æ–¥–≥—Ä–∞—Ñ—ã –≥–æ—Ç–æ–≤—ã!`
- `üåê –ó–∞–ø—É—Å–∫ Gateway...`

## üéØ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### –°–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- **1 –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** —Å 2 —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
- **4 –µ–¥–∏–Ω–∏—Ü—ã** —Å —Ä–∞–∑–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- **3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —Å —Ä–æ–ª—è–º–∏ (Owner, Manager, Staff)
- **3 –≥–æ—Å—Ç—è** —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- **3 –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** (—Ä–∞–∑–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã)
- **2 –∑–∞–¥–∞—á–∏** (—É–±–æ—Ä–∫–∞ –∏ —Ä–µ–º–æ–Ω—Ç)
- **2 –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ —É—Å–ª—É–≥** (CleanCo, RepairPro)
- **1 —Å—á–µ—Ç** —Å –ø–ª–∞—Ç–µ–∂–æ–º
- **–ü—Ä–∞–≤–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã** –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ DATABASE_URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å PostgreSQL —Å–µ—Ä–≤–µ—Ä–∞
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall –∏ security groups

### 2. **–°–∏–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ**
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–∏–¥—ã –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è
- –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —É–¥–∞–ª–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î

### 3. **pnpm –∫–æ–º–∞–Ω–¥—ã**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pnpm -C packages/datalayer-prisma` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
- TypeScript —Å–∏–¥—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `tsx`
- JavaScript —Å–∏–¥—ã —á–µ—Ä–µ–∑ `node`

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —É –≤–∞—Å –±—É–¥–µ—Ç:
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ **–ë–æ–≥–∞—Ç—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π**
- ‚úÖ **–†–∞–±–æ—Ç–∞—é—â–∞—è GraphQL Federation**
- ‚úÖ **–ì–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**

–¢–µ–ø–µ—Ä—å –≤–∞—à —Å–µ—Ä–≤–∏—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–µ–Ω —Å –±–æ–≥–∞—Ç—ã–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏! üöÄ
