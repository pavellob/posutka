# Workflow —É–±–æ—Ä–æ–∫ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram

## üìã –ü–æ–ª–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —É–±–æ—Ä–∫–∏

### **1. –°–æ–∑–¥–∞–Ω–∏–µ Task ‚Üí Cleaning**
- –°–æ–∑–¥–∞–µ—Ç—Å—è Task —Å —Ç–∏–ø–æ–º `CLEANING` –≤ ops-subgraph
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —á–µ—Ä–µ–∑ gRPC —Å–æ–∑–¥–∞–µ—Ç—Å—è Cleaning –≤ cleaning-subgraph
- **–õ–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
  - ‚úÖ –ï—Å–ª–∏ `cleanerId` —É–∫–∞–∑–∞–Ω ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `CLEANING_ASSIGNED` —É–±–æ—Ä—â–∏–∫—É
  - ‚úÖ –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `CLEANING_AVAILABLE` –≤—Å–µ–º –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º —É–±–æ—Ä—â–∏–∫–∞–º

---

### **2. CLEANING_ASSIGNED (—É–±–æ—Ä–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞)**

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É–±–æ—Ä—â–∏–∫—É:**
```
üßπ –ù–æ–≤–∞—è —É–±–æ—Ä–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞!

–í–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ —É–±–æ—Ä–∫–∞ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ "–ü–µ—Ç—Ä–æ–≥–∞ - –ö–≤–∞—Ä—Ç–∏—Ä–∞ 1"

–î–∞—Ç–∞: 25 –æ–∫—Ç—è–±—Ä—è 2025 –≥., 10:00

‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–º–µ–Ω–∞ –ø–æ—Å—Ç–µ–ª—å–Ω–æ–≥–æ –±–µ–ª—å—è (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)
```

**–ö–Ω–æ–ø–∫–∞ –≤ Telegram:**
```
‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —É–±–æ—Ä–∫—É
‚Üí https://tenorless-thallic-christene.ngrok-free.dev/cleanings/start/{id}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –£–±–æ—Ä—â–∏–∫ –∫–ª–∏–∫–∞–µ—Ç –∫–Ω–æ–ø–∫—É
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/cleanings/start/{id}`
3. –í–∏–¥–∏—Ç –¥–µ—Ç–∞–ª–∏ —É–±–æ—Ä–∫–∏
4. –ö–ª–∏–∫–∞–µ—Ç "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —É–±–æ—Ä–∫—É"
5. –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è: `SCHEDULED` ‚Üí `IN_PROGRESS`
6. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ `CLEANING_STARTED`

---

### **3. CLEANING_STARTED (—É–±–æ—Ä–∫–∞ –Ω–∞—á–∞—Ç–∞)**

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É–±–æ—Ä—â–∏–∫—É (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ):**
```
‚ñ∂Ô∏è –í—ã –Ω–∞—á–∞–ª–∏ —É–±–æ—Ä–∫—É

–í—ã –Ω–∞—á–∞–ª–∏ —É–±–æ—Ä–∫—É –≤ "–ü–µ—Ç—Ä–æ–≥–∞ - –ö–≤–∞—Ä—Ç–∏—Ä–∞ 1"

‚è±Ô∏è –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞: 10:05

üí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤ —á–µ–∫–ª–∏—Å—Ç–∞
```

**–ö–Ω–æ–ø–∫–∞ –≤ Telegram:**
```
‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É
‚Üí https://tenorless-thallic-christene.ngrok-free.dev/cleanings/complete/{id}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –£–±–æ—Ä—â–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç —É–±–æ—Ä–∫—É
3. –ö–ª–∏–∫–∞–µ—Ç –∫–Ω–æ–ø–∫—É "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É" –≤ Telegram
4. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/cleanings/complete/{id}`
5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
6. –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è: `IN_PROGRESS` ‚Üí `COMPLETED`
7. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ `CLEANING_COMPLETED`

---

### **4. CLEANING_COMPLETED (—É–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞)**

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É–±–æ—Ä—â–∏–∫—É (–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å):**
```
‚úÖ –£–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —É–±–æ—Ä–∫—É –≤ "–ü–µ—Ç—Ä–æ–≥–∞ - –ö–≤–∞—Ä—Ç–∏—Ä–∞ 1"

‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1—á 30–º–∏–Ω

‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É!
```

**–ö–Ω–æ–ø–∫–∞ –≤ Telegram:**
```
–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á–µ—Ç ‚Üí
‚Üí https://tenorless-thallic-christene.ngrok-free.dev/cleanings/{id}
```

---

### **5. CLEANING_AVAILABLE (–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Å–∞–º–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è)**

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º —É–±–æ—Ä—â–∏–∫–∞–º:**
```
üÜì –î–æ—Å—Ç—É–ø–Ω–∞ —É–±–æ—Ä–∫–∞!

–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ —É–±–æ—Ä–∫–∞ –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ "–ü–µ—Ç—Ä–æ–≥–∞ - –ö–≤–∞—Ä—Ç–∏—Ä–∞ 1"

–î–∞—Ç–∞: 25 –æ–∫—Ç—è–±—Ä—è 2025 –≥., 10:00

‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–º–µ–Ω–∞ –ø–æ—Å—Ç–µ–ª—å–Ω–æ–≥–æ –±–µ–ª—å—è (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)

üí° –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –≤–∑—è—Ç—å —É–±–æ—Ä–∫—É –≤ —Ä–∞–±–æ—Ç—É
```

**–ö–Ω–æ–ø–∫–∞ –≤ Telegram:**
```
‚úã –í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É
‚Üí https://tenorless-thallic-christene.ngrok-free.dev/cleanings/assign/{id}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –£–±–æ—Ä—â–∏–∫ –∫–ª–∏–∫–∞–µ—Ç –∫–Ω–æ–ø–∫—É
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/cleanings/assign/{id}`
3. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
4. Cleaning –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: `cleanerId` = —É–±–æ—Ä—â–∏–∫—É
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ `CLEANING_ASSIGNED`
6. Workflow –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è —Å —à–∞–≥–∞ 2

---

## üéØ –°—Ç—Ä–∞–Ω–∏—Ü—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### **1. `/cleanings/assign/{id}` - –°–∞–º–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ —É–±–æ—Ä–∫–∏
- –ö–Ω–æ–ø–∫–∞ "‚úã –í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É"
- –ù–∞–∑–Ω–∞—á–∞–µ—Ç —É–±–æ—Ä–∫—É –Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### **2. `/cleanings/start/{id}` - –ù–∞—á–∞–ª–æ —É–±–æ—Ä–∫–∏**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ —É–±–æ—Ä–∫–∏
- –ö–Ω–æ–ø–∫–∞ "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —É–±–æ—Ä–∫—É"
- –ú–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `IN_PROGRESS`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ `CLEANING_STARTED`

### **3. `/cleanings/complete/{id}` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É–±–æ—Ä–∫–∏**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ —É–±–æ—Ä–∫–∏
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —á–µ–∫–ª–∏—Å—Ç –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
- –ö–Ω–æ–ø–∫–∞ "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É"
- –ú–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `COMPLETED`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ `CLEANING_COMPLETED`

### **4. `/cleanings/{id}` - –î–µ—Ç–∞–ª–∏ —É–±–æ—Ä–∫–∏**
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É–±–æ—Ä–∫–µ
- –ß–µ–∫–ª–∏—Å—Ç —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
- **–£–º–Ω—ã–µ –∫–Ω–æ–ø–∫–∏:**
  - –ï—Å–ª–∏ `SCHEDULED` ‚Üí –∫–Ω–æ–ø–∫–∞ "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å"
  - –ï—Å–ª–∏ `IN_PROGRESS` ‚Üí –∫–Ω–æ–ø–∫–∞ "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å"
  - –ï—Å–ª–∏ `COMPLETED` ‚Üí —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä

---

## üìä –°—Ö–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π

```
SCHEDULED (–Ω–∞–∑–Ω–∞—á–µ–Ω–∞)
    ‚îÇ
    ‚îÇ startCleaning() ‚Üê –ö–Ω–æ–ø–∫–∞ "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å"
    ‚îÇ                   –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: CLEANING_STARTED
    ‚Üì
IN_PROGRESS (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
    ‚îÇ
    ‚îÇ completeCleaning() ‚Üê –ö–Ω–æ–ø–∫–∞ "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å"
    ‚îÇ                      –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: CLEANING_COMPLETED
    ‚Üì
COMPLETED (–∑–∞–≤–µ—Ä—à–µ–Ω–∞)
```

---

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

| –°–æ–±—ã—Ç–∏–µ | –ü–æ–ª—É—á–∞—Ç–µ–ª—å | –¢—Ä–∏–≥–≥–µ—Ä | –ö–Ω–æ–ø–∫–∞ |
|---------|-----------|---------|--------|
| `CLEANING_ASSIGNED` | –£–±–æ—Ä—â–∏–∫ | –°–æ–∑–¥–∞–Ω–∏–µ —Å cleanerId | ‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —É–±–æ—Ä–∫—É |
| `CLEANING_AVAILABLE` | –ü—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ —É–±–æ—Ä—â–∏–∫–∏ | –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑ cleanerId | ‚úã –í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É |
| `CLEANING_STARTED` | –£–±–æ—Ä—â–∏–∫ | –ù–∞—á–∞–ª–æ —É–±–æ—Ä–∫–∏ | ‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É |
| `CLEANING_COMPLETED` | –£–±–æ—Ä—â–∏–∫ | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É–±–æ—Ä–∫–∏ | –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á–µ—Ç ‚Üí |
| `CLEANING_CANCELLED` | –£–±–æ—Ä—â–∏–∫ | –û—Ç–º–µ–Ω–∞ —É–±–æ—Ä–∫–∏ | - |

---

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è

### **–ù–µ–ª—å–∑—è –Ω–∞—á–∞—Ç—å —É–±–æ—Ä–∫—É, –µ—Å–ª–∏:**
- ‚ùå –°—Ç–∞—Ç—É—Å –Ω–µ `SCHEDULED`
- ‚ùå –£–±–æ—Ä–∫–∞ —É–∂–µ –Ω–∞—á–∞—Ç–∞ –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### **–ù–µ–ª—å–∑—è –∑–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É, –µ—Å–ª–∏:**
- ‚ùå –°—Ç–∞—Ç—É—Å –Ω–µ `IN_PROGRESS`
- ‚ùå –£–±–æ—Ä–∫–∞ –Ω–µ –Ω–∞—á–∞—Ç–∞

### **–ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —á–µ–∫–ª–∏—Å—Ç:**
- ‚ö†Ô∏è –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- ‚úÖ –ù–æ –º–æ–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –ø—É—Ç—å —á–µ—Ä–µ–∑ Telegram

**1. –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:**
```
Telegram ‚Üí CLEANING_ASSIGNED ‚Üí "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å —É–±–æ—Ä–∫—É" 
         ‚Üí /cleanings/start/{id} 
         ‚Üí –ù–∞—á–∞—Ç—å
```

**2. –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã:**
```
Telegram ‚Üí CLEANING_STARTED ‚Üí "‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —É–±–æ—Ä–∫—É"
         ‚Üí /cleanings/complete/{id}
         ‚Üí –ó–∞–≤–µ—Ä—à–∏—Ç—å
```

**3. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:**
```
Telegram ‚Üí CLEANING_COMPLETED ‚Üí "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á–µ—Ç ‚Üí"
         ‚Üí /cleanings/{id}
```

**–í–µ—Å—å —Ü–∏–∫–ª –≤ 2 –∫–ª–∏–∫–∞ –∏–∑ Telegram!** üöÄ

---

## üìù –°–º. —Ç–∞–∫–∂–µ:
- [TASK_TO_CLEANING_AUTO_CREATE.md](./TASK_TO_CLEANING_AUTO_CREATE.md) - –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ Cleaning –∏–∑ Task
- [CLEANING_SELF_ASSIGNMENT.md](./CLEANING_SELF_ASSIGNMENT.md) - –°–∞–º–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —É–±–æ—Ä–æ–∫
- [GRPC_ARCHITECTURE.md](./GRPC_ARCHITECTURE.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ gRPC

